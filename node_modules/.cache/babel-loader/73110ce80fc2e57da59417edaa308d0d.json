{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\huachuan\\\\Desktop\\\\uniswap-front-interface\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\Users\\\\huachuan\\\\Desktop\\\\uniswap-front-interface\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{ETHER}from'@uniswap/sdk';import React,{useCallback,useContext,useEffect,useMemo,useRef,useState}from'react';import ReactGA from'react-ga';import{useTranslation}from'react-i18next';import{Text}from'rebass';import{ThemeContext}from'styled-components';import{useActiveWeb3React}from'../../hooks';import{useAllTokens,useToken}from'../../hooks/Tokens';import{useSelectedListInfo}from'../../state/lists/hooks';import{CloseIcon,LinkStyledButton,TYPE}from'../../theme';import{isAddress}from'../../utils';import Card from'../Card';import Column from'../Column';import ListLogo from'../ListLogo';import QuestionHelper from'../QuestionHelper';import Row,{RowBetween}from'../Row';import CommonBases from'./CommonBases';import CurrencyList from'./CurrencyList';import{filterTokens}from'./filtering';import SortButton from'./SortButton';import{useTokenComparator}from'./sorting';import{PaddedColumn,SearchInput,Separator}from'./styleds';import AutoSizer from'react-virtualized-auto-sizer';export function CurrencySearch(_ref){var selectedCurrency=_ref.selectedCurrency,onCurrencySelect=_ref.onCurrencySelect,otherSelectedCurrency=_ref.otherSelectedCurrency,showCommonBases=_ref.showCommonBases,onDismiss=_ref.onDismiss,isOpen=_ref.isOpen,onChangeList=_ref.onChangeList;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var theme=useContext(ThemeContext);var fixedList=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchQuery=_useState2[0],setSearchQuery=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),invertSearchOrder=_useState4[0],setInvertSearchOrder=_useState4[1];var allTokens=useAllTokens();// if they input an address, use it\nvar isAddressSearch=isAddress(searchQuery);var searchToken=useToken(searchQuery);useEffect(function(){if(isAddressSearch){ReactGA.event({category:'Currency Select',action:'Search by address',label:isAddressSearch});}},[isAddressSearch]);var showETH=useMemo(function(){var s=searchQuery.toLowerCase().trim();return s===''||s==='e'||s==='et'||s==='eth';},[searchQuery]);var tokenComparator=useTokenComparator(invertSearchOrder);var filteredTokens=useMemo(function(){if(isAddressSearch)return searchToken?[searchToken]:[];return filterTokens(Object.values(allTokens),searchQuery);},[isAddressSearch,searchToken,allTokens,searchQuery]);var filteredSortedTokens=useMemo(function(){if(searchToken)return[searchToken];var sorted=filteredTokens.sort(tokenComparator);var symbolMatch=searchQuery.toLowerCase().split(/\\s+/).filter(function(s){return s.length>0;});if(symbolMatch.length>1)return sorted;return[].concat(_toConsumableArray(searchToken?[searchToken]:[]),_toConsumableArray(sorted.filter(function(token){var _token$symbol;return((_token$symbol=token.symbol)===null||_token$symbol===void 0?void 0:_token$symbol.toLowerCase())===symbolMatch[0];})),_toConsumableArray(sorted.filter(function(token){var _token$symbol2;return((_token$symbol2=token.symbol)===null||_token$symbol2===void 0?void 0:_token$symbol2.toLowerCase())!==symbolMatch[0];})));},[filteredTokens,searchQuery,searchToken,tokenComparator]);var handleCurrencySelect=useCallback(function(currency){onCurrencySelect(currency);onDismiss();},[onDismiss,onCurrencySelect]);// clear the input on open\nuseEffect(function(){if(isOpen)setSearchQuery('');},[isOpen]);// manage focus on modal show\nvar inputRef=useRef();var handleInput=useCallback(function(event){var _fixedList$current;var input=event.target.value;var checksummedInput=isAddress(input);setSearchQuery(checksummedInput||input);(_fixedList$current=fixedList.current)===null||_fixedList$current===void 0?void 0:_fixedList$current.scrollTo(0);},[]);var handleEnter=useCallback(function(e){if(e.key==='Enter'){var s=searchQuery.toLowerCase().trim();if(s==='eth'){handleCurrencySelect(ETHER);}else if(filteredSortedTokens.length>0){var _filteredSortedTokens;if(((_filteredSortedTokens=filteredSortedTokens[0].symbol)===null||_filteredSortedTokens===void 0?void 0:_filteredSortedTokens.toLowerCase())===searchQuery.trim().toLowerCase()||filteredSortedTokens.length===1){handleCurrencySelect(filteredSortedTokens[0]);}}}},[filteredSortedTokens,handleCurrencySelect,searchQuery]);var selectedListInfo=useSelectedListInfo();return/*#__PURE__*/React.createElement(Column,{style:{width:'100%',flex:'1 1'}},/*#__PURE__*/React.createElement(PaddedColumn,{gap:\"14px\"},/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(Text,{fontWeight:500,fontSize:16},\"Select a token\",/*#__PURE__*/React.createElement(QuestionHelper,{text:\"Find a token by searching for its name or symbol or by pasting its address below.\"})),/*#__PURE__*/React.createElement(CloseIcon,{onClick:onDismiss})),/*#__PURE__*/React.createElement(SearchInput,{type:\"text\",id:\"token-search-input\",placeholder:t('tokenSearchPlaceholder'),value:searchQuery,ref:inputRef,onChange:handleInput,onKeyDown:handleEnter}),showCommonBases&&/*#__PURE__*/React.createElement(CommonBases,{chainId:chainId,onSelect:handleCurrencySelect,selectedCurrency:selectedCurrency}),/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(Text,{fontSize:14,fontWeight:500},\"Token Name\"),/*#__PURE__*/React.createElement(SortButton,{ascending:invertSearchOrder,toggleSortOrder:function toggleSortOrder(){return setInvertSearchOrder(function(iso){return!iso;});}}))),/*#__PURE__*/React.createElement(Separator,null),/*#__PURE__*/React.createElement(\"div\",{style:{flex:'1'}},/*#__PURE__*/React.createElement(AutoSizer,{disableWidth:true},function(_ref2){var height=_ref2.height;return/*#__PURE__*/React.createElement(CurrencyList,{height:height,showETH:showETH,currencies:filteredSortedTokens,onCurrencySelect:handleCurrencySelect,otherCurrency:otherSelectedCurrency,selectedCurrency:selectedCurrency,fixedListRef:fixedList});})),/*#__PURE__*/React.createElement(Separator,null),/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(RowBetween,null,selectedListInfo.current?/*#__PURE__*/React.createElement(Row,null,selectedListInfo.current.logoURI?/*#__PURE__*/React.createElement(ListLogo,{style:{marginRight:12},logoURI:selectedListInfo.current.logoURI,alt:\"\".concat(selectedListInfo.current.name,\" list logo\")}):null,/*#__PURE__*/React.createElement(TYPE.main,{id:\"currency-search-selected-list-name\"},selectedListInfo.current.name)):null,/*#__PURE__*/React.createElement(LinkStyledButton,{style:{fontWeight:500,color:theme.text2,fontSize:16},onClick:onChangeList,id:\"currency-search-change-list-button\"},selectedListInfo.current?'Change':'Select a list'))));}","map":{"version":3,"sources":["C:/Users/huachuan/Desktop/uniswap-front-interface/src/components/SearchModal/CurrencySearch.tsx"],"names":["ETHER","React","useCallback","useContext","useEffect","useMemo","useRef","useState","ReactGA","useTranslation","Text","ThemeContext","useActiveWeb3React","useAllTokens","useToken","useSelectedListInfo","CloseIcon","LinkStyledButton","TYPE","isAddress","Card","Column","ListLogo","QuestionHelper","Row","RowBetween","CommonBases","CurrencyList","filterTokens","SortButton","useTokenComparator","PaddedColumn","SearchInput","Separator","AutoSizer","CurrencySearch","selectedCurrency","onCurrencySelect","otherSelectedCurrency","showCommonBases","onDismiss","isOpen","onChangeList","t","chainId","theme","fixedList","searchQuery","setSearchQuery","invertSearchOrder","setInvertSearchOrder","allTokens","isAddressSearch","searchToken","event","category","action","label","showETH","s","toLowerCase","trim","tokenComparator","filteredTokens","Object","values","filteredSortedTokens","sorted","sort","symbolMatch","split","filter","length","token","symbol","handleCurrencySelect","currency","inputRef","handleInput","input","target","value","checksummedInput","current","scrollTo","handleEnter","e","key","selectedListInfo","width","flex","iso","height","logoURI","marginRight","name","fontWeight","color","text2","fontSize"],"mappings":"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","sourcesContent":["import { Currency, ETHER, Token } from '@uniswap/sdk'\nimport React, { KeyboardEvent, RefObject, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react'\nimport ReactGA from 'react-ga'\nimport { useTranslation } from 'react-i18next'\nimport { FixedSizeList } from 'react-window'\nimport { Text } from 'rebass'\nimport { ThemeContext } from 'styled-components'\nimport { useActiveWeb3React } from '../../hooks'\nimport { useAllTokens, useToken } from '../../hooks/Tokens'\nimport { useSelectedListInfo } from '../../state/lists/hooks'\nimport { CloseIcon, LinkStyledButton, TYPE } from '../../theme'\nimport { isAddress } from '../../utils'\nimport Card from '../Card'\nimport Column from '../Column'\nimport ListLogo from '../ListLogo'\nimport QuestionHelper from '../QuestionHelper'\nimport Row, { RowBetween } from '../Row'\nimport CommonBases from './CommonBases'\nimport CurrencyList from './CurrencyList'\nimport { filterTokens } from './filtering'\nimport SortButton from './SortButton'\nimport { useTokenComparator } from './sorting'\nimport { PaddedColumn, SearchInput, Separator } from './styleds'\nimport AutoSizer from 'react-virtualized-auto-sizer'\n\ninterface CurrencySearchProps {\n  isOpen: boolean\n  onDismiss: () => void\n  selectedCurrency?: Currency | null\n  onCurrencySelect: (currency: Currency) => void\n  otherSelectedCurrency?: Currency | null\n  showCommonBases?: boolean\n  onChangeList: () => void\n}\n\nexport function CurrencySearch({\n  selectedCurrency,\n  onCurrencySelect,\n  otherSelectedCurrency,\n  showCommonBases,\n  onDismiss,\n  isOpen,\n  onChangeList\n}: CurrencySearchProps) {\n  const { t } = useTranslation()\n  const { chainId } = useActiveWeb3React()\n  const theme = useContext(ThemeContext)\n\n  const fixedList = useRef<FixedSizeList>()\n  const [searchQuery, setSearchQuery] = useState<string>('')\n  const [invertSearchOrder, setInvertSearchOrder] = useState<boolean>(false)\n  const allTokens = useAllTokens()\n\n  // if they input an address, use it\n  const isAddressSearch = isAddress(searchQuery)\n  const searchToken = useToken(searchQuery)\n\n  useEffect(() => {\n    if (isAddressSearch) {\n      ReactGA.event({\n        category: 'Currency Select',\n        action: 'Search by address',\n        label: isAddressSearch\n      })\n    }\n  }, [isAddressSearch])\n\n  const showETH: boolean = useMemo(() => {\n    const s = searchQuery.toLowerCase().trim()\n    return s === '' || s === 'e' || s === 'et' || s === 'eth'\n  }, [searchQuery])\n\n  const tokenComparator = useTokenComparator(invertSearchOrder)\n\n  const filteredTokens: Token[] = useMemo(() => {\n    if (isAddressSearch) return searchToken ? [searchToken] : []\n    return filterTokens(Object.values(allTokens), searchQuery)\n  }, [isAddressSearch, searchToken, allTokens, searchQuery])\n\n  const filteredSortedTokens: Token[] = useMemo(() => {\n    if (searchToken) return [searchToken]\n    const sorted = filteredTokens.sort(tokenComparator)\n    const symbolMatch = searchQuery\n      .toLowerCase()\n      .split(/\\s+/)\n      .filter(s => s.length > 0)\n    if (symbolMatch.length > 1) return sorted\n\n    return [\n      ...(searchToken ? [searchToken] : []),\n      // sort any exact symbol matches first\n      ...sorted.filter(token => token.symbol?.toLowerCase() === symbolMatch[0]),\n      ...sorted.filter(token => token.symbol?.toLowerCase() !== symbolMatch[0])\n    ]\n  }, [filteredTokens, searchQuery, searchToken, tokenComparator])\n\n  const handleCurrencySelect = useCallback(\n    (currency: Currency) => {\n      onCurrencySelect(currency)\n      onDismiss()\n    },\n    [onDismiss, onCurrencySelect]\n  )\n\n  // clear the input on open\n  useEffect(() => {\n    if (isOpen) setSearchQuery('')\n  }, [isOpen])\n\n  // manage focus on modal show\n  const inputRef = useRef<HTMLInputElement>()\n  const handleInput = useCallback(event => {\n    const input = event.target.value\n    const checksummedInput = isAddress(input)\n    setSearchQuery(checksummedInput || input)\n    fixedList.current?.scrollTo(0)\n  }, [])\n\n  const handleEnter = useCallback(\n    (e: KeyboardEvent<HTMLInputElement>) => {\n      if (e.key === 'Enter') {\n        const s = searchQuery.toLowerCase().trim()\n        if (s === 'eth') {\n          handleCurrencySelect(ETHER)\n        } else if (filteredSortedTokens.length > 0) {\n          if (\n            filteredSortedTokens[0].symbol?.toLowerCase() === searchQuery.trim().toLowerCase() ||\n            filteredSortedTokens.length === 1\n          ) {\n            handleCurrencySelect(filteredSortedTokens[0])\n          }\n        }\n      }\n    },\n    [filteredSortedTokens, handleCurrencySelect, searchQuery]\n  )\n\n  const selectedListInfo = useSelectedListInfo()\n\n  return (\n    <Column style={{ width: '100%', flex: '1 1' }}>\n      <PaddedColumn gap=\"14px\">\n        <RowBetween>\n          <Text fontWeight={500} fontSize={16}>\n            Select a token\n            <QuestionHelper text=\"Find a token by searching for its name or symbol or by pasting its address below.\" />\n          </Text>\n          <CloseIcon onClick={onDismiss} />\n        </RowBetween>\n        <SearchInput\n          type=\"text\"\n          id=\"token-search-input\"\n          placeholder={t('tokenSearchPlaceholder')}\n          value={searchQuery}\n          ref={inputRef as RefObject<HTMLInputElement>}\n          onChange={handleInput}\n          onKeyDown={handleEnter}\n        />\n        {showCommonBases && (\n          <CommonBases chainId={chainId} onSelect={handleCurrencySelect} selectedCurrency={selectedCurrency} />\n        )}\n        <RowBetween>\n          <Text fontSize={14} fontWeight={500}>\n            Token Name\n          </Text>\n          <SortButton ascending={invertSearchOrder} toggleSortOrder={() => setInvertSearchOrder(iso => !iso)} />\n        </RowBetween>\n      </PaddedColumn>\n\n      <Separator />\n\n      <div style={{ flex: '1' }}>\n        <AutoSizer disableWidth>\n          {({ height }) => (\n            <CurrencyList\n              height={height}\n              showETH={showETH}\n              currencies={filteredSortedTokens}\n              onCurrencySelect={handleCurrencySelect}\n              otherCurrency={otherSelectedCurrency}\n              selectedCurrency={selectedCurrency}\n              fixedListRef={fixedList}\n            />\n          )}\n        </AutoSizer>\n      </div>\n\n      <Separator />\n      <Card>\n        <RowBetween>\n          {selectedListInfo.current ? (\n            <Row>\n              {selectedListInfo.current.logoURI ? (\n                <ListLogo\n                  style={{ marginRight: 12 }}\n                  logoURI={selectedListInfo.current.logoURI}\n                  alt={`${selectedListInfo.current.name} list logo`}\n                />\n              ) : null}\n              <TYPE.main id=\"currency-search-selected-list-name\">{selectedListInfo.current.name}</TYPE.main>\n            </Row>\n          ) : null}\n          <LinkStyledButton\n            style={{ fontWeight: 500, color: theme.text2, fontSize: 16 }}\n            onClick={onChangeList}\n            id=\"currency-search-change-list-button\"\n          >\n            {selectedListInfo.current ? 'Change' : 'Select a list'}\n          </LinkStyledButton>\n        </RowBetween>\n      </Card>\n    </Column>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}